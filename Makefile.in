srcdir       := @srcdir@/src
BaseDir      := $(srcdir)/
KaitaiDir    := $(BaseDir)kaitai/
SQLiteCppDir := $(BaseDir)SQLiteCpp/
Blake2Dir    := $(BaseDir)blake2/ref/
UtilDir      := $(BaseDir)util/

CC       = @CC@
CXX      = @CXX@
LIBS     = @LIBS@ @PCAPPLUSPLUS_LIBS@ @BOOST_ASIO_LIB@ @BOOST_FILESYSTEM_LIB@ @BOOST_IOSTREAMS_LIB@ @BOOST_PROGRAM_OPTIONS_LIB@ @BOOST_SYSTEM_LIB@
CPPFLAGS = @DEFS@ @CPPFLAGS@ @BOOST_CPPFLAGS@ -I$(KaitaiDir) -I$(SQLiteCppDir) -I$(Blake2Dir) -I$(UtilDir) -I$(BaseDir)
CFLAGS   = @CFLAGS@ @SQLITE3_CFLAGS@ @PCAPPLUSPLUS_CFLAGS@
CXXFLAGS = @CXXFLAGS@ @SQLITE3_CFLAGS@ @PCAPPLUSPLUS_CFLAGS@
LDFLAGS  = @LDFLAGS@
VPATH    = .
@SET_MAKE@

all: nanocap

include $(srcdir)/Makefile.deps

OBJECTS = nano.oo webserver.oo packet_handler.oo app.oo db.oo kaitai.oo SQLiteCpp-Exception.oo SQLiteCpp-Statement.oo SQLiteCpp-Database.oo SQLiteCpp-Transaction.oo SQLiteCpp-Column.oo SQLiteCpp-Backup.oo util.oo
OBJECTS += blake2-ref-blake2b-ref.o

nanocap: $(OBJECTS)
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) $(LDFLAGS) -o "$@" $^ $(LIBS)

%.oo:
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -o "$@" -c $(filter %.C %.cc %.cpp,$^)

%.o:
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -o "$@" -c $(filter %.c,$^)

clean:
	rm -f nanocap
	rm -f $(OBJECTS)

distclean: clean
	rm -f Makefile config.log config.status

mrproper: distclean
	rm -f config.guess config.sub configure install-sh aclocal.m4

.PHONY: all clean distclean mrproper
.SUFFIXES:
